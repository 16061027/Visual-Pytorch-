# 设计文档

前端有若干个模块【可拖动的方框】可供用户选择，用户根据这些模块来搭建模型。除了这些模块，还需要一个单独的模块【不能拖动的方框】，里面是需要由用户指定的全局变量。下面对这些方框进行说明。其中，名字前面带有‘*’的为需要用户输入的参数，带有‘-’的为需要用户选择的参数，为空的则为前端根据图形能自动生成的。

## 可拖动的方框

### view_layer：reshape层

参数：

- *shape (int[]) : reshape的维度，由用户输入，需要注意的是这里用户可能输入很多个数字，所以需要对文本框中用户的输入进行识别，约定相邻数字之间以逗号','分隔。

### linear_layer: 全连接层

参数：

- *in_channel (int) : 输入的channel
- *out_channel (int) : 输出的channel。

### conv1d_layer:一维卷积层

参数：

- *in_channel (int) : 输入的信号的通道
- *out_channel (int) : 卷积产生的通道
- *kernel_size (int) : 卷积核的尺寸
- *stride (int) : 卷积步长
- *padding (int) : 补充0的层数
- -activity (string) : 激活函数的类型，由用户选择，可选类型如下：
  - torch.nn.functional.relu
  - torch.nn.functional.leaky_relu
  - torch.nn.functional.sigmoid
  - torch.nn.functional.tanh
  - torch.nn.functional.softmax
  - 默认为None。
- -pool_way (string) : 池化函数的类型，由用户选择，可选类型如下：
  - torch.nn.functional.max_pool1d
  - torch.nn.functional.max_pool2d
  - torch.nn.functional.max_pool3d
  - torch.nn.AvgPool1d
  - torch.nn.AvgPool2d
  - torch.nn.AvgPool3d
  - 默认为None。

### conv2d_layer:二维卷积层

参数：

- *in_channel (int) : 输入的信号的通道
- *out_channel (int) : 卷积产生的通道
- *kernel_size (int) : 卷积核的尺寸
- *stride (int) : 卷积步长
- *padding (int) : 补充0的层数
- -activity (string) : 激活函数的类型，由用户选择，可选类型如下：
  - torch.nn.functional.relu
  - torch.nn.functional.leaky_relu
  - torch.nn.functional.sigmoid
  - torch.nn.functional.tanh
  - torch.nn.functional.softmax
  - 默认为None。
- -pool_way (string) : 池化函数的类型，由用户选择，可选类型如下：
  - torch.nn.functional.max_pool1d
  - torch.nn.functional.max_pool2d
  - torch.nn.functional.max_pool3d
  - torch.nn.AvgPool1d
  - torch.nn.AvgPool2d
  - torch.nn.AvgPool3d
  - 默认为None。

## 不可拖动的方框

参数：

- *epoch (int) : 训练轮次，默认为1
- -optimizer (string) : 优化器的选择，可供选择的有：
  - torch.optim.Optimizer
  - torch.optim.Adam
  - torch.optim.Adam
  - torch.optim.ASGD
  - 默认为Adam
- *learning_rate (int) : 学习速率，默认为0.5
- *batch_size (int) : 训练batch的大小
- *x_data (string) : 数据X的名字， 默认为None【训练时候才会用到】
- *y_data (string) :  数据X的名字， 默认为None【训练时候才会用到】
- *data_dir (string) : 数据所在目录， 默认为None
- *data_set (string) : 数据集的名字，默认为None
- -train (boolean) : 是否训练，由用户选择，可选内容如下
  - True
  - False
  - 默认为True

## 接口调用方法

前端在获得了神经网络模型的相关数据后只需要调用接口**main_func(edge_record)**即可实现模型代码的生成，下面是对该接口的具体说明：

### 参数：

- edge_record(json) –输入神经网络模型的相关数据。

### 数据约定：

- edge_record是一个json数组，每个数组元素对应用户连接的一条边，同时记录了两个端点的字段信息，还附加了一个区别于其他端点的id字段，name字段表明该端点连接的层的类型。

### 使用：

```python
main, model, ops = main_func(edge_record)
```

其中main,  model, ops 是三个字符串数组，代表三个.py文件。